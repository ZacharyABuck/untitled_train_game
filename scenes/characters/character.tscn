[gd_scene load_steps=22 format=3 uid="uid://crisc7glr0lru"]

[ext_resource type="Texture2D" uid="uid://4x8a5b3tydex" path="res://sprites/characters/sprite_sheets/timbo.png" id="1_6ggv8"]
[ext_resource type="Script" path="res://scripts/characters/character.gd" id="1_7ww7q"]
[ext_resource type="Script" path="res://scripts/characters/character_state_machine.gd" id="2_1ccev"]
[ext_resource type="Script" path="res://scripts/characters/character_state_idle.gd" id="4_45hgv"]
[ext_resource type="Script" path="res://scripts/characters/character_state_running.gd" id="5_3q3pl"]
[ext_resource type="PackedScene" uid="uid://bnhgqxmsn3vu1" path="res://components/health_component.tscn" id="6_t77if"]
[ext_resource type="Script" path="res://components/HurtboxComponent.gd" id="7_0odwf"]
[ext_resource type="AudioStream" uid="uid://clkk66hf1rpbc" path="res://sounds/combat/character_ow.mp3" id="8_vb2pc"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_swtlo"]
size = Vector2(32, 38)

[sub_resource type="AtlasTexture" id="AtlasTexture_8c01f"]
atlas = ExtResource("1_6ggv8")
region = Rect2(64, 128, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_xnmn5"]
atlas = ExtResource("1_6ggv8")
region = Rect2(0, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_bev52"]
atlas = ExtResource("1_6ggv8")
region = Rect2(64, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_14igq"]
atlas = ExtResource("1_6ggv8")
region = Rect2(128, 0, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_ybcwq"]
atlas = ExtResource("1_6ggv8")
region = Rect2(0, 64, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_3oqak"]
atlas = ExtResource("1_6ggv8")
region = Rect2(64, 64, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_pvgcn"]
atlas = ExtResource("1_6ggv8")
region = Rect2(128, 64, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_k4g6w"]
atlas = ExtResource("1_6ggv8")
region = Rect2(0, 128, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_ohwjq"]
atlas = ExtResource("1_6ggv8")
region = Rect2(64, 128, 64, 64)

[sub_resource type="AtlasTexture" id="AtlasTexture_08oyj"]
atlas = ExtResource("1_6ggv8")
region = Rect2(128, 128, 64, 64)

[sub_resource type="SpriteFrames" id="SpriteFrames_xi46m"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_8c01f")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_xnmn5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bev52")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_14igq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ybcwq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_3oqak")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pvgcn")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_k4g6w")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ohwjq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_08oyj")
}],
"loop": true,
"name": &"running",
"speed": 20.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_xf4c1"]
size = Vector2(36, 42)

[node name="Character" type="CharacterBody2D" groups=["character"]]
collision_layer = 512
collision_mask = 1536
script = ExtResource("1_7ww7q")
state = "idle"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_swtlo")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
scale = Vector2(0.6, 0.6)
sprite_frames = SubResource("SpriteFrames_xi46m")
animation = &"running"
frame = 4
frame_progress = 0.28382

[node name="StateMachine" type="Node2D" parent="."]
script = ExtResource("2_1ccev")

[node name="idle" type="Node2D" parent="StateMachine"]
process_mode = 4
script = ExtResource("4_45hgv")

[node name="running" type="Node2D" parent="StateMachine"]
process_mode = 4
script = ExtResource("5_3q3pl")

[node name="MoveTimer" type="Timer" parent="."]
wait_time = 5.0
autostart = true

[node name="IdleTimer" type="Timer" parent="."]
wait_time = 2.0

[node name="HealthComponent" parent="." node_paths=PackedStringArray("HEALTHBAR") instance=ExtResource("6_t77if")]
MAX_HEALTH = 20.0
HEALTHBAR = NodePath("../ProgressBar")

[node name="HurtboxComponent" type="Area2D" parent="." node_paths=PackedStringArray("health_component", "hurt_sfx")]
script = ExtResource("7_0odwf")
health_component = NodePath("../HealthComponent")
hurt_sfx = NodePath("../HurtSFX")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HurtboxComponent"]
shape = SubResource("RectangleShape2D_xf4c1")

[node name="ProgressBar" type="ProgressBar" parent="."]
modulate = Color(1, 0.211765, 0.196078, 1)
offset_left = -28.0
offset_top = -31.0
offset_right = 28.0
offset_bottom = -24.0
max_value = 20.0
value = 20.0
show_percentage = false

[node name="HurtSFX" type="AudioStreamPlayer" parent="."]
stream = ExtResource("8_vb2pc")
volume_db = -15.0
bus = &"SFX"

[connection signal="timeout" from="MoveTimer" to="StateMachine/idle" method="_on_move_timer_timeout"]
[connection signal="timeout" from="IdleTimer" to="StateMachine/running" method="_on_idle_timer_timeout"]
